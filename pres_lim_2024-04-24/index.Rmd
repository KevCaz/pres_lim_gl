---
title: "Estimation of Food Webs Interactions with Linear Inverse Models"
author: "Kevin Cazelles et al."
date: "2024-04-24"
output:
  xaringan::moon_reader:
    css: [default, rd.css, rd-font.css, "hygge"]
    lib_dir: assets
    seal: false
    nature:
      highlightStyle: dracula
      countIncrementalSlides: false
      beforeInit: "macros.js"
---


class: title-slide, middle


# Estimation of Food Webs Interactions with Linear Inverse Models

.instructors[
  .font180[**Kevin Cazelles, Kevin McCann & Kayla Hale**]
  <br><br>
  .font120[2024-04-24]
]


<div class="logo">
<img src="img/logo_cfem.png" height="100px"></img>
<img src="img/logo_uog.jpg" height="120px"></img>
</div>

```{r setup, include = FALSE}
library(iseWorkshops)
```

---
class: inverse, center, middle

# Introduction

![:custom_hr]()


---
# Linear Inverse Models

### Solve a system with a set of equalities and inequalities

</br>

.pull-left[

$$\mathbf{E} \mathbf{x} = \mathbf{f}$$

$$\mathbf{E} \mathbf{x} \approx \mathbf{b}$$

$$\mathbf{E} \mathbf{x} \geq \mathbf{g}$$

]


---
# Linear Inverse Models


### Solve a system with a set of equalities and inequalities

</br>


.pull-left[

$$\mathbf{E} \color{black}{\mathbf{x}} = \mathbf{f}$$

$$\mathbf{E} \color{black}{\mathbf{x}} \approx \mathbf{b}$$

$$\mathbf{E} \color{black}{\mathbf{x}} \geq \mathbf{g}$$

]


.pull-right[

$$2\color{black}{x} = 12$$

</br>

$$2\color{black}{x} + \color{black}{y} > 12$$


]



---
# Linear Inverse Models


### Solve a system with a set of equalities and inequalities

</br>

.pull-left[

$$\mathbf{E} \color{black}{\mathbf{x}} = \mathbf{f}$$

$$\mathbf{E} \color{black}{\mathbf{x}} \approx \mathbf{b}$$

$$\mathbf{E} \color{black}{\mathbf{x}} \geq \mathbf{g}$$

]


.pull-right[

$$2\color{black}{x} = 12$$

</br>

$$2\color{black}{x} + \color{black}{y} > 12$$

$$\color{black}{x} > 0;  \color{black}{y} > 0$$
$$\color{black}{y} < 4 $$
]


--
### Large array of problems 

- Optimal transportation, clustering, solving Sudoku, etc.
- `r lk()` https://jump.dev/JuMP.jl/stable/tutorials/linear/diet/


---
# Linear Inverse Models in Food Webs


![:scalec 70%](img/biomass_balance.png)

- `r bk()` Soetaert & Van Oevelen (2009), **Oceanography**. 


???
You may know some flows


---
# Linear Inverse Models in Food Webs

![:scalec 60%](img/simplified_fw.png)

- Biomasses known
- Linear relationships among flux
- `r bk()` Soetaert & Van Oevelen (2009), **Oceanography**. 


---
# Linear Inverse Models in Food Webs

![:scalec 65%](img/constraints.png)

- `r bk()` Soetaert & Van Oevelen (2009), **Oceanography**. 


---
# Linear Inverse Models in Food Webs

![:scalec 75%](img/results.png)

- `r bk()` Soetaert & Van Oevelen (2009), **Oceanography**. 


---
# Linear Inverse Models in Food Webs

## A note about Ecopath

- **Ecopath**: mass balance modeling
- 2 master equations 

```
Production = catch + predation + net migration + 
  biomass accumulation + other mortality

Consumption = production + respiration + unassimilated food
```

- `r lk()` https://ecopath.org/about/#toggle-id-1



---
# Linear Inverse Models in Food Webs

## Let's keep in mind 

1. LIM approach can be used to combine a set of constriants on a mass balance model to estimate the masse/energy flows;

2. the more the constraints, the smaller the solution space.



---

class: inverse, center, middle

# LIM and food web stability

![:custom_hr]()



---
# LIM in classical Lotka-Volterra

</br>

$$\begin{equation}\begin{aligned}
\frac{dPrey}{dt}      &= Prey \left( r_{Prey} + \alpha_{1, 1} Prey - \alpha_{1, 2} Predator \right) \\
\frac{dPredator}{dt}  &= Predator \left( r_{Predator} + \alpha_{2, 1} Prey \right)
\end{aligned}\end{equation}$$


---
# LIM in classical Lotka-Volterra

</br>

$$\begin{equation}\begin{aligned}
\frac{d\color{black}{Prey}}{dt}      &= \color{black}{Prey} \left( r_{Prey} + \alpha_{1, 1} \color{black}{Prey} - \alpha_{1, 2} \color{black}{Predator} \right) \\
\frac{d\color{black}{Predator}}{dt}  &= \color{black}{Predator} \left( r_{Predator} + \alpha_{2, 1} \color{black}{Prey} \right)
\end{aligned}\end{equation}$$

Classicaly: 

1. variation of $Predator$ and $Prey$ population (individuals, biomass)
2. study of the stability of the system 


---
# LIM in classical Lotka-Volterra

### Assumptions 

- near equilibrium 
- biomass known

$$\begin{equation}\begin{aligned}
\left( r_{Prey} + \alpha_{1, 1} Prey - \alpha_{1, 2} Predator \right) &= 0\\
\left( r_{Predator} + \alpha_{2, 1} Prey \right) &= 0
\end{aligned}\end{equation}$$


---
# LIM in classical Lotka-Volterra

### Assumptions 

- near equilibrium 
- biomass known

$$\begin{equation}\begin{aligned}
0 &= \left( r_{Prey} + \color{black}{\alpha_{1, 1}} Prey - \color{black}{\alpha_{1, 2}} Predator \right) \\
0 &= \left( r_{Predator} + \color{black}{\alpha_{2, 1}} Prey \right)
\end{aligned}\end{equation}$$


---
# LIM in classical Lotka-Volterra

### Example 

1. Prey and Predator biomass known 
2. Interaction are positive + Prey `r ar()` Predator **<** Prey `r ar()` Predator

![:scalec 67%](img/res-1.png)



---
# LIM in classical Lotka-Volterra

![:scalec 45%](img/compare1-1.png)

???
if stability taken as resilience so..


---
# Using more contraints

![:scalec 56%](img/gellner.png)


- `r bk()` Gellner, McCann & Hasting (2023), **PNAS**. 


---
# Using more contraints

![:scalec 68%](img/gellner2.png)


- `r bk()` Gellner, McCann & Hasting (2023), **PNAS**. 




---

class: inverse, center, middle

# Solving management challenges with LIM 

![:custom_hr]()


<!-- more examples from the package -->



---
class: inverse, center, middle

# Interactive tool (Shiny App)

![:custom_hr]()


<!-- demo here 10 min -->
