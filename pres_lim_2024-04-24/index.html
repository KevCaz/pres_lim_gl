<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Estimation of Food Webs Interactions with Linear Inverse Models</title>
    <meta charset="utf-8" />
    <meta name="author" content="Kevin Cazelles et al." />
    <meta name="date" content="2024-04-24" />
    <script src="assets/header-attrs-2.26/header-attrs.js"></script>
    <link href="assets/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="assets/remark-css-0.0.1/hygge.css" rel="stylesheet" />
    <link rel="stylesheet" href="rd.css" type="text/css" />
    <link rel="stylesheet" href="rd-font.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">



class: title-slide, middle


# Estimation of Food Webs Interactions with Linear Inverse Models

.instructors[
  .font180[**Kevin Cazelles, Kevin McCann &amp; Kayla Hale**]
  &lt;br&gt;&lt;br&gt;
  .font120[2024-04-24]
]


&lt;div class="logo"&gt;
&lt;img src="img/logo_cfem.png" height="100px"&gt;&lt;/img&gt;
&lt;img src="img/logo_uog.jpg" height="120px"&gt;&lt;/img&gt;
&lt;/div&gt;



---
class: inverse, center, middle

# Introduction

![:custom_hr]()


---
# Linear Inverse Models

### Solve systems of equalities, inequalities and approximations


.pull-left[

`$$\mathbf{E} \mathbf{x} = \mathbf{f}$$`

`$$\mathbf{E} \mathbf{x} \approx \mathbf{b}$$`

`$$\mathbf{E} \mathbf{x} \geq \mathbf{g}$$`

]

---
# Linear Inverse Models


### Solve systems of equalities, inequalities and approximations


.pull-left[

`$$\mathbf{E} \color{red}{\mathbf{x}} = \mathbf{f}$$`

`$$\mathbf{E} \color{red}{\mathbf{x}} \approx \mathbf{b}$$`

`$$\mathbf{E} \color{red}{\mathbf{x}} \geq \mathbf{g}$$`

]


---
# Linear Inverse Models


### Solve systems of equalities, inequalities and approximations


.pull-left[

`$$\mathbf{E} \color{red}{\mathbf{x}} = \mathbf{f}$$`

`$$\mathbf{E} \color{red}{\mathbf{x}} \approx \mathbf{b}$$`

`$$\mathbf{E} \color{red}{\mathbf{x}} \geq \mathbf{g}$$`

]


.pull-right[

`$$2\color{red}{x} = 12$$`

&lt;/br&gt;

`$$2\color{red}{x} + \color{red}{y} = 12$$`

2 unknown variables, 1 equality

]


---
# Linear Inverse Models


### Solve systems of equalities, inequalities and approximations



.pull-left[

`$$\mathbf{E} \color{red}{\mathbf{x}} = \mathbf{f}$$`

`$$\mathbf{E} \color{red}{\mathbf{x}} \approx \mathbf{b}$$`

`$$\mathbf{E} \color{red}{\mathbf{x}} \geq \mathbf{g}$$`

]


.pull-right[

`$$2\color{red}{x} = 12$$`

&lt;/br&gt;

`$$\color{red}{y} = 12 - 2\color{red}{x}$$`

in other words, a **line** 

]


---
# Linear Inverse Models

### Solve systems of equalities, inequalities and approximations

.pull-left[

`$$\mathbf{E} \color{red}{\mathbf{x}} = \mathbf{f}$$`

`$$\mathbf{E} \color{red}{\mathbf{x}} \approx \mathbf{b}$$`

`$$\mathbf{E} \color{red}{\mathbf{x}} \geq \mathbf{g}$$`

]


.pull-right[

`$$2\color{red}{x} = 12$$`

&lt;/br&gt;

`$$2\color{red}{x} + \color{red}{y} = 12$$`

`$$\color{red}{x} &gt; 0;  \color{red}{y} &gt; 0$$`
$$\color{red}{y} &lt; 4 $$
]

all `\((\color{red}{x}, \color{red}{y})\)` such as `\(\color{red}{y} = 12 - 2\color{red}{x}\)` and `\(x \in ]4, 6[\)` : a **segment**

--
### Large array of problems 

- Optimal transportation, clustering, solving Sudoku, etc.
- <svg aria-hidden="true" role="img" viewBox="0 0 640 512" style="height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"/></svg> https://jump.dev/JuMP.jl/stable/tutorials/linear/diet/


---
# Linear Inverse Models in Food Webs


![:scalec 75%](img/biomass_balance.png)

- <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M96 0C43 0 0 43 0 96V416c0 53 43 96 96 96H384h32c17.7 0 32-14.3 32-32s-14.3-32-32-32V384c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H384 96zm0 384H352v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16H336c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48H336c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg> Soetaert &amp; Van Oevelen (2009), **Oceanography**. 


???
You may know some flows


---
# Linear Inverse Models in Food Webs


.pull-left[
  &lt;/br&gt;
  $$\frac{dB_i}{dt} = f_1 + f_2 + f_3 + ... $$

]

.pull-right[
  ![:scalec 85%](img/whole_web.png)
  
]

--

- Mass balance 

--

- A set of equalities 

--

- Some knowledge about flows:
  - known parameters: `\(f_1 = 2.5\)`
  - inequalities: `\(f_1 &gt; f_2\)`
  - approximations: `\(f_1 \approx 2.5\)`

--


---
# Linear Inverse Models in Food Webs

$$\frac{dB_i}{dt} = f_1 + f_2 + f_3 + ... $$

- Using LIM, we obtained a **space**, sets of working flows `\((f_1, f_2, ...)\)`


![:scalec 45%](img/space.png)





---
# Linear Inverse Models in Food Webs

![:scalec 75%](img/results.png)

- <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M96 0C43 0 0 43 0 96V416c0 53 43 96 96 96H384h32c17.7 0 32-14.3 32-32s-14.3-32-32-32V384c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H384 96zm0 384H352v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16H336c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48H336c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg> Soetaert &amp; Van Oevelen (2009), **Oceanography**. 


---
# Linear Inverse Models in Food Webs

## A note about Ecopath

- **Ecopath**: mass balance modelling
- 2 master equations 

```
Production = catch + predation + net migration + 
  biomass accumulation + other mortality

Consumption = production + respiration + unassimilated food
```

- <svg aria-hidden="true" role="img" viewBox="0 0 640 512" style="height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"/></svg> https://ecopath.org/about/#toggle-id-1



---

class: inverse, center, middle

# LIM for food web resilience

![:custom_hr]()



---
# LIM in classical Lotka-Volterra

&lt;/br&gt;

`$$\begin{equation}\begin{aligned}
\frac{dPrey}{dt}      &amp;= Prey \left( r_{Prey} + a_{1, 1} Prey - a_{1, 2} Predator \right) \\
\frac{dPredator}{dt}  &amp;= Predator \left( r_{Predator} + a_{2, 1} Prey \right)
\end{aligned}\end{equation}$$`

- Functional response type I


---
# LIM in classical Lotka-Volterra

&lt;/br&gt;

`$$\begin{equation}\begin{aligned}
\frac{d\color{red}{Prey}}{dt}      &amp;= \color{red}{Prey} \left( r_{Prey} + a_{1, 1} \color{red}{Prey} - a_{1, 2} \color{red}{Predator} \right) \\
\frac{d\color{red}{Predator}}{dt}  &amp;= \color{red}{Predator} \left( r_{Predator} + a_{2, 1} \color{red}{Prey} \right)
\end{aligned}\end{equation}$$`

Classically: 

1. interactions are known 
2. we look variations of `\(Predator\)` and `\(Prey\)` population (individuals, biomass)
3. study of the stability of the system 


---
# LIM in classical Lotka-Volterra

### Assumptions 

- biomass known
- near equilibrium we have:


`$$\begin{equation}\begin{aligned}
\left( r_{Prey} + a_{1, 1} \color{red}{Prey} - a_{1, 2} \color{red}{Predator} \right) &amp;= 0\\
\left( r_{Predator} + a_{2, 1} \color{red}{Prey} \right) &amp;= 0
\end{aligned}\end{equation}$$`


---
# LIM in classical Lotka-Volterra

### Assumptions 

- biomass known
- near equilibrium we have:

`$$\begin{equation}\begin{aligned}
\left( r_{Prey} + \color{red}{a_{1, 1}} Prey - \color{red}{a_{1, 2}} Predator \right) &amp;= 0\\ 
\left( r_{Predator} + \color{red}{a_{2, 1}} Prey \right) &amp;= 0
\end{aligned}\end{equation}$$`

--

### Let's use LIM

- 2 equalities 
- 3 unknown variables: **interaction strengths** that are hard to measure
-  `\(Prey\)` and `\(Predator\)` are known: **biomass/population known**
- **Interactions are positive**
- **Interactions are asymmetrical**:
  - conversion efficiency: `\(a_{1, 2} &gt; a_{2,1}\)`


---
# Sets of interactions strengths

Sets of interactions strengths that lead to the observed biomass

|  `\(a_{1,1}\)`| `\(a_{2,1}\)` | `\(a_{1,2}\)` |
|---------:|-----:|--------:|
| 0.1326175|     1| 1.867382|
| 0.2158816|     1| 1.784118|
| 0.0697550|     1| 1.930245|
| 0.3031896|     1| 1.696810|
| 0.0743744|     1| 1.925626|
| 0.2347560|     1| 1.765244|
| 0.4509523|     1| 1.549048|
| 0.3427189|     1| 1.657281|
| 0.3577168|     1| 1.642283|


---
# Distribution of interactions strengths

![:scalec 75%](img/distrib_2sp.png)



---
# Resilience metric

`$$\begin{equation}\begin{aligned}
\frac{dPrey}{dt}      &amp;= Prey \left( r_{Prey} + a_{1, 1} Prey - a_{1, 2} Predator \right) \\
\frac{dPredator}{dt}  &amp;= Predator \left( r_{Predator} + a_{2, 1} Prey \right)
\end{aligned}\end{equation}$$`

- We use the Jacobian to determine the **leading eigen value** a proxy for **reslience**


---
# Distribution of interactions strengths

![:scalec 75%](img/distrib_2sp_points.png)


---
# Distribution of interactions strengths

![:scalec 75%](img/distrib_2sp_stab.png)


---
# Distribution of interactions strengths

![:scalec 75%](img/distrib_2sp_stab_res.png)



---
# Most stable system

![:scalec 65%](img/most_stable.png)

???
if stability taken as resilience so...

---
# Least stable system

![:scalec 65%](img/least_stable.png)


---
# LIM in classical Lotka-Volterra


- Distribution of **interactions** = portray of the **biostructure**  

--

- Distribution of **resilience** of potential biostructures 

--

- The more constraints, the smaller the space

--

- Dynamics can be used to select among potential biostructures! 



---
# Using more constraints

### No Constraints 


- Diversity increases <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"/></svg> stability decreases 

![:scalec 50%](img/rel_classic.png)


- <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M96 0C43 0 0 43 0 96V416c0 53 43 96 96 96H384h32c17.7 0 32-14.3 32-32s-14.3-32-32-32V384c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H384 96zm0 384H352v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16H336c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48H336c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg> Gellner, McCann &amp; Hasting (2023), **PNAS**. 


---
# Using more constraints

### Realistic constraints


- Diversity increases <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"/></svg> stability decreases 

![:scalec 50%](img/rel_no.png)


???
it is a very hopeful results if you use constraints interaction inference 
may be doable





---

class: inverse, center, middle

# Towards Solving Management Challenges With LIM 

![:custom_hr]()

???
go over various potential avenues where we can use LIM


---
# A five species example

.pull-left[
![:scalec 50%](img/net5.png)

- 5 species, 10 interactions
- **assumptions**:
  - Lotka-Volterra
  - biomass/population known 
]

.pull-right[
.font50[
|Symbol        | Name                        |
|:------------ |:--------------------------- |
|$$a_{1, 1}$$   | intraspecific competition  |
|$$a_{1, 3}$$   | prey -&gt; predator           |
|$$a_{2, 2}$$   | intraspecific competition  |
|$$a_{2, 4}$$   | prey -&gt; predator           |
|$$a_{3, 1}$$   | predator &lt;- prey           |
|$$a_{3, 5}$$   | predator -&gt; top predator   |
|$$a_{4, 2}$$   | predator &lt;- prey           |
|$$a_{4, 5}$$   | predator -&gt; top predator   |
|$$a_{5, 3}$$   | top predator &lt;- predator   |
|$$a_{5, 4}$$   | top predator &lt;- predator   |
]

]

---
# A five species example

.pull-left[
![:scalec 50%](img/net5.png)

- 5 species, 10 interactions
- **assumptions**:
  - Lotka-Volterra
  - biomass/population known 
]

.pull-right[

### constraints

interaction strengths are:

- positive
- asymmetrical `\(a_{1,3} &gt; a_{3,1}\)`

]

---
# A five species example - resilience 

![:scalec 82%](img/distrib_5sp_res.png)

- Potential biostructures and their resilience


---
# Lest stable vs. top 25% most stable

![:scalec 90%](img/most_25.png)


---
# Lest stable vs. top 10% most stable

![:scalec 90%](img/most_10.png)


---
# Lest stable vs. top 1% most stable

![:scalec 90%](img/most_1.png)



---
# Analyzing temporal variation 

![:scalec 85%](img/drawing_ts.png)


---
# Analyzing temporal variation 

![:scalec 90%](img/3phases_all.png)



---
# Analyzing temporal variation 

![:scalec 60%](img/3phases_all_stab.png)





---
# Future Challenges 


## A flexible tools to add constraints 

- allometric constraints (previous presentation)
- constraints based on time series (variation of biomass)

--

## Work on real food webs 

- This requires **data** (next presentation)
  - food webs topology  (spatially explicit)
  - biomass time series
  - interactions constraints 
 

---
# Expected outcomes 

1. Paper: "Towards Solving Management Challenges With LIM"

2. R package: "fwebinfr"

3. Shiny App 


---
class: inverse, center, middle

# Interactive tool (Shiny App)

![:custom_hr]()




&lt;!-- demo here 5-10 min --&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "dracula",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
